(window.webpackJsonp=window.webpackJsonp||[]).push([[642],{2391:function(e,t,_){"use strict";_.r(t);var v=_(2),o=Object(v.a)({},(function(){var e=this,t=e.$createElement,_=e._self._c||t;return _("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[_("h1",{attrs:{id:"开发者武器库-程序员的专业工具箱"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#开发者武器库-程序员的专业工具箱"}},[e._v("#")]),e._v(" 开发者武器库 - 程序员的专业工具箱")]),e._v(" "),_("p",[e._v("Title")]),e._v(" "),_("p",[e._v("课前须知：")]),e._v(" "),_("ul",[_("li",[e._v("为了更好的学习体验，请购课后加卡颂微信（kasong555），发送"),_("a",{attrs:{href:"https://wechatapppro-1252524126.file.myqcloud.com/appjiz2zqrn2142/image/b_u_622f2474a891b_tuQ1ZmhR/lbfu8mqw0ssm.jpeg",target:"_blank",rel:"noopener noreferrer"}},[e._v("课程订单号"),_("OutboundLink")],1),e._v("，拉你进专属学习群")]),e._v(" "),_("li",[e._v("参与"),_("a",{attrs:{href:"https://wj.qq.com/s2/11444184/b3e4/",target:"_blank",rel:"noopener noreferrer"}},[e._v("2 个月通关 React 挑战"),_("OutboundLink")],1),e._v("，返现金")]),e._v(" "),_("li",[e._v("为了提高 PC 端观看体验，请安装"),_("a",{attrs:{href:"https://github.com/BetaSu/kasong-school",target:"_blank",rel:"noopener noreferrer"}},[e._v("卡颂课堂 chrome 插件"),_("OutboundLink")],1)]),e._v(" "),_("li",[_("a",{attrs:{href:"https://github.com/BetaSu/big-react/commit/83a35faeaf8ce1775e84466c750d81da3c4480f3",target:"_blank",rel:"noopener noreferrer"}},[e._v("本节课代码地址"),_("OutboundLink")],1)])]),e._v(" "),_("h1",{attrs:{id:"第十课-初探-update-流程"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#第十课-初探-update-流程"}},[e._v("#")]),e._v(" 第十课：初探 update 流程")]),e._v(" "),_("p",[_("code",[e._v("update")]),e._v("流程与"),_("code",[e._v("mount")]),e._v("流程的区别。")]),e._v(" "),_("p",[e._v("对于"),_("code",[e._v("beginWork")]),e._v("：")]),e._v(" "),_("ul",[_("li",[e._v("需要处理"),_("code",[e._v("ChildDeletion")]),e._v("的情况")]),e._v(" "),_("li",[e._v("需要处理节点移动的情况（abc -> bca）")])]),e._v(" "),_("p",[e._v("对于"),_("code",[e._v("completeWork")]),e._v("：")]),e._v(" "),_("ul",[_("li",[e._v("需要处理"),_("code",[e._v("HostText")]),e._v("内容更新的情况")]),e._v(" "),_("li",[e._v("需要处理"),_("code",[e._v("HostComponent")]),e._v("属性变化的情况")])]),e._v(" "),_("p",[e._v("对于"),_("code",[e._v("commitWork")]),e._v("：")]),e._v(" "),_("ul",[_("li",[e._v("对于"),_("code",[e._v("ChildDeletion")]),e._v("，需要遍历被删除的子树")]),e._v(" "),_("li",[e._v("对于"),_("code",[e._v("Update")]),e._v("，需要更新文本内容")])]),e._v(" "),_("p",[e._v("对于"),_("code",[e._v("useState")]),e._v("：")]),e._v(" "),_("ul",[_("li",[e._v("实现相对于"),_("code",[e._v("mountState")]),e._v("的"),_("code",[e._v("updateState")])])]),e._v(" "),_("h2",{attrs:{id:"beginwork-流程"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#beginwork-流程"}},[e._v("#")]),e._v(" beginWork 流程")]),e._v(" "),_("p",[e._v("本节课仅处理单一节点，所以省去了**「节点移动」**的情况。我们需要处理：")]),e._v(" "),_("ul",[_("li",[e._v("singleElement")]),e._v(" "),_("li",[e._v("singleTextNode")])]),e._v(" "),_("p",[e._v("处理流程为：")]),e._v(" "),_("ol",[_("li",[_("p",[e._v("比较是否可以复用"),_("code",[e._v("current fiber")])])]),e._v(" "),_("li",[_("p",[e._v("比较"),_("code",[e._v("key")]),e._v("，如果"),_("code",[e._v("key")]),e._v("不同，不能复用")])]),e._v(" "),_("li",[_("p",[e._v("比较"),_("code",[e._v("type")]),e._v("，如果"),_("code",[e._v("type")]),e._v("不同，不能复用")])]),e._v(" "),_("li",[_("p",[e._v("如果"),_("code",[e._v("key")]),e._v("与"),_("code",[e._v("type")]),e._v("都相同，则可复用")])]),e._v(" "),_("li",[_("p",[e._v("不能复用，则创建新的（同"),_("code",[e._v("mount")]),e._v("流程），可以复用则复用旧的")])])]),e._v(" "),_("p",[e._v("注意：对于同一个"),_("code",[e._v("fiberNode")]),e._v("，即使反复更新，"),_("code",[e._v("current")]),e._v("、"),_("code",[e._v("wip")]),e._v("这两个"),_("code",[e._v("fiberNode")]),e._v("会重复使用")]),e._v(" "),_("h2",{attrs:{id:"completework-流程"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#completework-流程"}},[e._v("#")]),e._v(" completeWork 流程")]),e._v(" "),_("p",[e._v("主要处理**「标记 Update」**的情况，本节课我们处理"),_("code",[e._v("HostText")]),e._v("内容更新的情况。")]),e._v(" "),_("h2",{attrs:{id:"commitwork-流程"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#commitwork-流程"}},[e._v("#")]),e._v(" commitWork 流程")]),e._v(" "),_("p",[e._v("对于标记"),_("code",[e._v("ChildDeletion")]),e._v("的子树，由于子树中：")]),e._v(" "),_("ul",[_("li",[e._v("对于"),_("code",[e._v("FC")]),e._v("，需要处理"),_("code",[e._v("useEffect")]),e._v(" "),_("code",[e._v("unmout")]),e._v("执行、解绑"),_("code",[e._v("ref")])]),e._v(" "),_("li",[e._v("对于"),_("code",[e._v("HostComponent")]),e._v("，需要解绑"),_("code",[e._v("ref")])]),e._v(" "),_("li",[e._v("对于子树的"),_("code",[e._v("根HostComponent")]),e._v("，需要移除"),_("code",[e._v("DOM")])])]),e._v(" "),_("p",[e._v("所以需要实现**「遍历 ChildDeletion 子树」**的流程")]),e._v(" "),_("h2",{attrs:{id:"对于-usestate"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#对于-usestate"}},[e._v("#")]),e._v(" 对于 useState")]),e._v(" "),_("p",[e._v("需要实现：")]),e._v(" "),_("ul",[_("li",[e._v("针对"),_("code",[e._v("update")]),e._v("时的"),_("code",[e._v("dispatcher")])]),e._v(" "),_("li",[e._v("实现对标"),_("code",[e._v("mountWorkInProgresHook")]),e._v("的"),_("code",[e._v("updateWorkInProgresHook")])]),e._v(" "),_("li",[e._v("实现"),_("code",[e._v("updateState")]),e._v("中**「计算新 state 的逻辑」**")])]),e._v(" "),_("p",[e._v("其中"),_("code",[e._v("updateWorkInProgresHook")]),e._v("的实现需要考虑的问题：")]),e._v(" "),_("ul",[_("li",[e._v("hook 数据从哪来？")]),e._v(" "),_("li",[e._v("交互阶段触发的更新")])]),e._v(" "),_("p",[_("code",[e._v("<div onClick={() => update(1)}></div>")])]),e._v(" "),_("ul",[_("li",[_("code",[e._v("render")]),e._v("阶段触发的更新（TODO）")])]),e._v(" "),_("p",[_("code",[e._v("function App() { const [num, update] = useState(0); // 触发更新 update(100); return <div>{num}</div>; }")])]),e._v(" "),_("p",[_("strong",[e._v("欢迎访问 "),_("a",{attrs:{href:"https://devtool.tech",target:"_blank",rel:"noopener noreferrer"}},[e._v("DevTool"),_("OutboundLink")],1)])]),e._v(" "),_("p",[e._v("本工具地址: "),_("a",{attrs:{href:"http://devtool.tech/html-md",target:"_blank",rel:"noopener noreferrer"}},[e._v("Devtool/HTML-To-Markdown"),_("OutboundLink")],1)]),e._v(" "),_("h2",{attrs:{id:"联系方式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#联系方式"}},[e._v("#")]),e._v(" 联系方式")]),e._v(" "),_("ul",[_("li",[e._v("微信: shanyue94(山月)")]),e._v(" "),_("li",[e._v("Github: "),_("a",{attrs:{href:"https://github.com/shfshanyue",target:"_blank",rel:"noopener noreferrer"}},[e._v("shfshanyue"),_("OutboundLink")],1)]),e._v(" "),_("li",[e._v("博客: "),_("a",{attrs:{href:"https://shanyue.tech",target:"_blank",rel:"noopener noreferrer"}},[e._v("shanyue.tech"),_("OutboundLink")],1)])]),e._v(" "),_("h2",{attrs:{id:"联系方式-表格版"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#联系方式-表格版"}},[e._v("#")]),e._v(" 联系方式: 表格版")]),e._v(" "),_("table",[_("thead",[_("tr",[_("th",[e._v("账号")]),e._v(" "),_("th",[e._v("地址")])])]),e._v(" "),_("tbody",[_("tr",[_("td",[e._v("微信")]),e._v(" "),_("td",[e._v("shanyue94(山月)")])]),e._v(" "),_("tr",[_("td",[e._v("Github")]),e._v(" "),_("td",[e._v("shfshanyue")])]),e._v(" "),_("tr",[_("td",[e._v("博客")]),e._v(" "),_("td",[e._v("shanyue.tech")])])])])])}),[],!1,null,null,null);t.default=o.exports}}]);